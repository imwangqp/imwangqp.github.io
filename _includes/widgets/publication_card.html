{% assign publications = include.publications %}



{% comment %} 1. 提取所有一作论文并按日期降序 {% endcomment %}
{% assign first_author = publications | where: "is_first_author", true | sort: "date" | reverse %}

{% comment %} 2. 提取所有非一作论文并按日期降序 {% endcomment %}
{% assign non_first_author = publications | where_exp: "item", "item.is_first_author != true" | sort: "date" | reverse %}

<div class="my-3 p-0 bg-white shadow-sm rounded-sm">
    <h6 class="border-bottom border-gray p-3 mb-0">
        {% if include.title %}{{ include.title }}{% else %} Publications{% endif %}
    </h6>
    
    {% comment %} 一作论文部分 {% endcomment %}
    {% if first_author.size > 0 %}
    <div class="border-bottom border-gray p-3">
        <h6><i class="fas fa-star"></i> First-Author Publications</h6>
        {% for item in first_author limit:include.limit %}
            {% include widgets/publication_item.html item=item first=false last=false %}
        {% endfor %}
    </div>
    {% endif %}
    
    {% comment %} 非一作论文部分 {% endcomment %}
    {% if non_first_author.size > 0 %}
    <div class="p-3">
        <h6><i class="fas fa-users"></i> Collaborative Publications</h6>
        {% comment %} 计算非一作论文的显示限制 {% endcomment %}
        {% assign remaining_limit = include.limit | minus: first_author.size %}
        {% if remaining_limit > 0 %}
            {% for item in non_first_author limit:remaining_limit %}
                {% include widgets/publication_item.html item=item first=false last=false %}
            {% endfor %}
        {% endif %}
    </div>
    {% endif %}
</div>
